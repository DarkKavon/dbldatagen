<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Contributing to the Databricks Labs Data Generator &mdash; Databricks Labs Data Generator 0.3.3post2 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/tdg.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Databricks Labs Data Generator Release Notes" href="CHANGELOG.html" />
    <link rel="prev" title="dbldatagen.utils module" href="../reference/api/dbldatagen.utils.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Databricks Labs Data Generator
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../APIDOCS.html">Get Started Here</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation_notes.html">Installation instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generating_column_data.html">Generating column data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DATARANGES.html">Using data ranges</a></li>
<li class="toctree-l1"><a class="reference internal" href="../textdata.html">Generating text data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DISTRIBUTIONS.html">Using data distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../options_and_features.html">Options for column specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../repeatable_data_generation.html">Repeatable Data Generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../repeatable_data_generation.html#revisiting-the-iot-data-example">Revisiting the IOT data example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using_streaming_data.html">Using streaming data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generating_json_data.html">Generating JSON and structured column data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generating_cdc_data.html">Generating Change Data Capture (CDC) data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../multi_table_data.html">Using multiple tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../extending_text_generation.html">Extending text generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../troubleshooting.html">Troubleshooting data generation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="quickindex.html">Quick API index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/api/modules.html">The dbldatagen package API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Contributing to the Databricks Labs Data Generator</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#license">License</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#building-the-code">Building the code</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#package-dependencies">Package Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="#python-compatibility">Python compatibility</a></li>
<li class="toctree-l2"><a class="reference internal" href="#checking-your-code-for-common-issues">Checking your code for common issues</a></li>
<li class="toctree-l2"><a class="reference internal" href="#setting-up-your-build-environment">Setting up your build environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="#build-steps">Build steps</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#building-with-conda">Building with Conda</a></li>
<li class="toctree-l3"><a class="reference internal" href="#building-with-pipenv">Building with Pipenv</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#creating-the-html-documentation">Creating the HTML documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#building-the-python-wheel">Building the Python wheel</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#testing">Testing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#developing-new-tests">Developing new tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="#running-unit-integration-tests">Running unit / integration tests</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#using-the-databricks-labs-data-generator">Using the Databricks Labs data generator</a></li>
<li class="toctree-l1"><a class="reference internal" href="#coding-style">Coding Style</a></li>
<li class="toctree-l1"><a class="reference internal" href="CHANGELOG.html">Change log</a></li>
<li class="toctree-l1"><a class="reference internal" href="requirements.html">Build requirements</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">License</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Databricks Labs Data Generator</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Contributing to the Databricks Labs Data Generator</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/relnotes/CONTRIBUTING.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="contributing-to-the-databricks-labs-data-generator">
<h1>Contributing to the Databricks Labs Data Generator<a class="headerlink" href="#contributing-to-the-databricks-labs-data-generator" title="Permalink to this heading"></a></h1>
<p>We happily welcome contributions to <em>dbldatagen</em>.</p>
<p>We use GitHub Issues to track community reported issues and GitHub Pull Requests for accepting changes.</p>
<section id="license">
<h2>License<a class="headerlink" href="#license" title="Permalink to this heading"></a></h2>
<p>When you contribute code, you affirm that the contribution is your original work and that you
license the work to the project under the project’s Databricks license. Whether or not you
state this explicitly, by submitting any copyrighted material via pull request, email, or
other means you agree to license the material under the project’s Databricks license and
warrant that you have the legal authority to do so.</p>
</section>
</section>
<section id="building-the-code">
<h1>Building the code<a class="headerlink" href="#building-the-code" title="Permalink to this heading"></a></h1>
<section id="package-dependencies">
<h2>Package Dependencies<a class="headerlink" href="#package-dependencies" title="Permalink to this heading"></a></h2>
<p>See the contents of the file <code class="docutils literal notranslate"><span class="pre">python/require.txt</span></code> to see the Python package dependencies.
Dependent packages are not installed automatically by the <code class="docutils literal notranslate"><span class="pre">dbldatagen</span></code> package.</p>
</section>
<section id="python-compatibility">
<h2>Python compatibility<a class="headerlink" href="#python-compatibility" title="Permalink to this heading"></a></h2>
<p>The code has been tested with Python 3.8.10 and later.</p>
<p>Older releases were tested with Python 3.7.5 but as of this release, it requires the Databricks runtime 9.1 LTS or later
which relies on Python 3.8.10</p>
</section>
<section id="checking-your-code-for-common-issues">
<h2>Checking your code for common issues<a class="headerlink" href="#checking-your-code-for-common-issues" title="Permalink to this heading"></a></h2>
<p>Run <code class="docutils literal notranslate"><span class="pre">./lint.sh</span></code> from the project root directory to run various code style checks.
These are based on the use of <code class="docutils literal notranslate"><span class="pre">prospector</span></code>, <code class="docutils literal notranslate"><span class="pre">pylint</span></code> and related tools.</p>
</section>
<section id="setting-up-your-build-environment">
<h2>Setting up your build environment<a class="headerlink" href="#setting-up-your-build-environment" title="Permalink to this heading"></a></h2>
<p>Run <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">buildenv</span></code> from the root of the project directory to setup a <code class="docutils literal notranslate"><span class="pre">pipenv</span></code> based build environment.</p>
<p>Run <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">create-dev-env</span></code> from the root of the project directory to
set up a conda based virtualized Python build environment in the project directory.</p>
<p>You can use alternative build virtualization environments or simply install the requirements
directly in your environment.</p>
</section>
<section id="build-steps">
<h2>Build steps<a class="headerlink" href="#build-steps" title="Permalink to this heading"></a></h2>
<p>Our recommended mechanism for building the code is to use a <code class="docutils literal notranslate"><span class="pre">conda</span></code> or <code class="docutils literal notranslate"><span class="pre">pipenv</span></code> based development process.</p>
<p>But it can be built with any Python virtualization environment.</p>
<section id="building-with-conda">
<h3>Building with Conda<a class="headerlink" href="#building-with-conda" title="Permalink to this heading"></a></h3>
<p>To build with <code class="docutils literal notranslate"><span class="pre">conda</span></code>, perform the following commands:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">create-dev-env</span></code> from the main project directory to create your conda environment, if using</p></li>
<li><p>activate the conda environment - e.g <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">activate</span> <span class="pre">dbl_testdatagenerator</span></code></p></li>
<li><p>install the necessary dependencies in your conda environment via <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">install-dev-dependencies</span></code></p></li>
<li><p>use the following to build and run the tests with a coverage report</p>
<ul>
<li><p>Run  <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">dev-test-with-html-report</span></code> from the main project directory.</p></li>
</ul>
</li>
<li><p>Use the following command to make the distributable:</p>
<ul>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">dev-dist</span></code> from the main project directory</p></li>
</ul>
</li>
<li><p>The resulting wheel file will be placed in the <code class="docutils literal notranslate"><span class="pre">dist</span></code> subdirectory</p></li>
</ul>
</section>
<section id="building-with-pipenv">
<h3>Building with Pipenv<a class="headerlink" href="#building-with-pipenv" title="Permalink to this heading"></a></h3>
<p>To build with <code class="docutils literal notranslate"><span class="pre">pipenv</span></code>, perform the following commands:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">buildenv</span></code> from the main project directory to create your conda environment, if using</p></li>
<li><p>install the necessary dependencies in your conda environment via <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">install-dev-dependencies</span></code></p></li>
<li><p>use the following to build and run the tests with a coverage report</p>
<ul>
<li><p>Run  <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">test-with-html-report</span></code> from the main project directory.</p></li>
</ul>
</li>
<li><p>Use the following command to make the distributable:</p>
<ul>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">dist</span></code> from the main project directory</p></li>
</ul>
</li>
<li><p>The resulting wheel file will be placed in the <code class="docutils literal notranslate"><span class="pre">dist</span></code> subdirectory</p></li>
</ul>
<p>The resulting build has been tested against Spark 3.0.1</p>
</section>
</section>
<section id="creating-the-html-documentation">
<h2>Creating the HTML documentation<a class="headerlink" href="#creating-the-html-documentation" title="Permalink to this heading"></a></h2>
<p>Run  <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">docs</span></code> from the main project directory.</p>
<p>The main html document will be in the file (relative to the root of the build directory)
<code class="docutils literal notranslate"><span class="pre">./docs/docs/build/html/index.html</span></code></p>
</section>
<section id="building-the-python-wheel">
<h2>Building the Python wheel<a class="headerlink" href="#building-the-python-wheel" title="Permalink to this heading"></a></h2>
<p>Run  <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">clean</span> <span class="pre">dist</span></code> from the main project directory.</p>
</section>
</section>
<section id="testing">
<h1>Testing<a class="headerlink" href="#testing" title="Permalink to this heading"></a></h1>
<section id="developing-new-tests">
<h2>Developing new tests<a class="headerlink" href="#developing-new-tests" title="Permalink to this heading"></a></h2>
<p>New tests should be created using PyTest with classes combining multiple <code class="docutils literal notranslate"><span class="pre">Pytest</span></code> tests.</p>
<p>Existing test code contains tests based on Python’s <code class="docutils literal notranslate"><span class="pre">unittest</span></code> framework but these are
run on <code class="docutils literal notranslate"><span class="pre">pytest</span></code> rather than <code class="docutils literal notranslate"><span class="pre">unitest</span></code>.</p>
<p>To get a  <code class="docutils literal notranslate"><span class="pre">spark</span></code> instance for test purposes, use the following code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">dbldatagen</span> <span class="k">as</span> <span class="nn">dg</span>

<span class="n">spark</span> <span class="o">=</span> <span class="n">dg</span><span class="o">.</span><span class="n">SparkSingleton</span><span class="o">.</span><span class="n">getLocalInstance</span><span class="p">(</span><span class="s2">&quot;&lt;name to flag spark instance&gt;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The name used to flag the spark instance should be the test module or test class name.</p>
</section>
<section id="running-unit-integration-tests">
<h2>Running unit / integration tests<a class="headerlink" href="#running-unit-integration-tests" title="Permalink to this heading"></a></h2>
<p>If using an environment with multiple Python versions, make sure to use virtual env or
similar to pick up correct python versions. The make target <code class="docutils literal notranslate"><span class="pre">create</span></code></p>
<p>If necessary, set <code class="docutils literal notranslate"><span class="pre">PYSPARK_PYTHON</span></code> and <code class="docutils literal notranslate"><span class="pre">PYSPARK_DRIVER_PYTHON</span></code> to point to correct versions of Python.</p>
<p>To run the tests using a <code class="docutils literal notranslate"><span class="pre">conda</span></code> environment:</p>
<ul class="simple">
<li><p>Run <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">dev-test</span></code> from the main project directory to run the unit tests.</p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">dev-test-with-html-report</span></code> to generate test coverage report in <code class="docutils literal notranslate"><span class="pre">htmlcov/inxdex.html</span></code></p></li>
</ul>
<p>To run the tests using a <code class="docutils literal notranslate"><span class="pre">pipenv</span></code> environment:</p>
<ul class="simple">
<li><p>Run <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">test</span></code> from the main project directory to run the unit tests.</p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">test-with-html-report</span></code> to generate test coverage report in <code class="docutils literal notranslate"><span class="pre">htmlcov/inxdex.html</span></code></p></li>
</ul>
</section>
</section>
<section id="using-the-databricks-labs-data-generator">
<h1>Using the Databricks Labs data generator<a class="headerlink" href="#using-the-databricks-labs-data-generator" title="Permalink to this heading"></a></h1>
<p>The recommended method for installation is to install from the PyPi package</p>
<p>You can install the library as a notebook scoped library when working within the Databricks
notebook environment through the use of a <code class="docutils literal notranslate"><span class="pre">%pip</span></code> cell in your notebook.</p>
<p>To install as a notebook-scoped library, create and execute a notebook cell with the following text:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">%pip</span> <span class="pre">install</span> <span class="pre">dbldatagen</span></code></p>
</div></blockquote>
<p>This installs from the PyPi package</p>
<p>You can also install from release binaries or directly from the Github sources.</p>
<p>The release binaries can be accessed at:</p>
<ul class="simple">
<li><p>Databricks Labs Github Data Generator releases - https://github.com/databrickslabs/dbldatagen/releases</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">%pip</span> <span class="pre">install</span></code> method also works on the Databricks Community Edition.</p>
<p>Alternatively, you use download a wheel file and install using the Databricks install mechanism to install a wheel based
library into your workspace.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">%pip</span> <span class="pre">install</span></code> method can also down load a specific binary release.
For example, the following code downloads the release V0.2.1</p>
<blockquote>
<div><p>‘%pip install https://github.com/databrickslabs/dbldatagen/releases/download/v021/dbldatagen-0.2.1-py3-none-any.whl’</p>
</div></blockquote>
</section>
<section id="coding-style">
<h1>Coding Style<a class="headerlink" href="#coding-style" title="Permalink to this heading"></a></h1>
<p>The code follows the Pyspark coding conventions.</p>
<p>Basically it follows the Python PEP8 coding conventions - but method and argument names used mixed case starting
with a lower case letter rather than underscores following Pyspark coding conventions.</p>
<p>See https://legacy.python.org/dev/peps/pep-0008/</p>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../reference/api/dbldatagen.utils.html" class="btn btn-neutral float-left" title="dbldatagen.utils module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="CHANGELOG.html" class="btn btn-neutral float-right" title="Databricks Labs Data Generator Release Notes" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Databricks Inc.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>